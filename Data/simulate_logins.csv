import pandas as pd
import random
from datetime import datetime, timedelta

def generate_login_data(num_users, num_records_per_user):
    user_ids = [f'U{i+1}' for i in range(num_users)]
    devices = [f'Device_{i+1}' for i in range(1, 5)]  # Simulating 4 different devices
    locations = ['New York', 'California', 'London', 'Berlin']

    data = []

    for user in user_ids:
        for _ in range(num_records_per_user):
            # Random timestamp between now and 30 days ago
            timestamp = datetime.now() - timedelta(days=random.randint(0, 30), hours=random.randint(0, 24))
            login_hour = timestamp.hour  # Extract hour of login

            # Random device and location selection
            device = random.choice(devices)
            ip_address = f"192.168.1.{random.randint(1, 255)}" if random.random() > 0.5 else f"10.0.0.{random.randint(1, 255)}"
            login_method = "Password" if random.random() > 0.2 else "Multi-factor Authentication"  # 80% chance of password
            location = random.choice(locations)
            
            # Random success/failure of login
            successful_login = 1 if random.random() > 0.1 else 0  # 90% success rate

            # Add record to the data
            data.append([user, timestamp, login_hour, device, ip_address, login_method, location, successful_login])

    # Convert to DataFrame
    df = pd.DataFrame(data, columns=["user_id", "timestamp", "login_hour", "device_id", "ip_address", "login_method", "location", "successful_login"])
    return df

def save_data_to_csv(df, filename="simulate_logins.csv"):
    # Save DataFrame to CSV
    df.to_csv(filename, index=False)
    print(f"Data saved to {filename}")

# Generate data for 10 users, each with 50 records
login_data = generate_login_data(num_users=10, num_records_per_user=50)

# Save the generated login data to a CSV file
save_data_to_csv(login_data)
